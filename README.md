米国株（S&P 500）について、**「今日から42営業日以内に大きな下落（例：DD到達など）が起きそうか」**を日次で判定し、結果を `data/latest.json` に保存します。
リスクが高いと判定したら **GitHub Issues で通知**します。

---

## 見方

### 1) まず `regime` を見る

`data/latest.json` の `regime` が現在の判定です。

* **平常**：放置でOK
* **注意 / 警戒 / 早期警戒**：リスク上昇中（念のため監視）
* **危機**：通知対象（Issueが出るゾーン）

### 2) 次に `p_any`（0〜1）を見る

`p_any` はざっくり **「今から42営業日以内に悪いイベントが起きる確率」**の合成スコアです。
数値が高いほどリスクが高いです。`score` はそれを 0〜100 に見やすくしただけです。

### 3) 「危機」確定の判定を見る（ある場合）

* `pre_alert`：早期警戒に入ったかどうか（入口）
* `crisis_confirmed`：最終的に危機として確定したかどうか
* `gate_status.passed`：ゲート（追加の条件）を通ったかどうか

  * `gate_status.signals` の各指標は、`z` が `thr` を超えると「危険側」です

> 迷ったら：**`regime` と `crisis_confirmed` だけ見れば足ります。**

---

## GitHub Issues の動き

この仕組みは「**暴落した当日に知らせる**」のではなく、**“これから42営業日のどこかで起きそう” と判定が危機に入った日**に通知します。

* **Issue作成**：`regime` が **危機に突入した日**（前日≠危機 → 当日=危機）
* **Issueに追記**：危機が続いている間、日次でコメント追記
* **Issueクローズ**：危機を抜けた日（危機 → 危機以外）
* **クールダウン**：クローズ後しばらくは連投しない（スパム防止）

---

## 生成されるファイル

* `data/latest.json`：最新の判定結果（これが本体）
* `data/history.csv.gz`：日次の履歴（あとで検証したい時用）
* `data/state.json`：Issueの状態管理
